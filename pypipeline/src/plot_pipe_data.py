import numpy as np
import matplotlib.pyplot as plt


def plot_pipe_pt_seq(pipe_pt_seq):
    """根据 pipe_pt_seq 数据绘制管道布线路径

    Args:
        pipe_pt_seq (List[List[np.ndarray]]): 每个内层列表代表一条路径，
            每个数组的 shape 为 (2,) 分别为 (x, y)
    """
    plt.figure(figsize=(10, 8))
    
    # 存储所有有效的x和y坐标
    all_xs = []
    all_ys = []
    
    # 遍历所有路径
    for idx, route in enumerate(pipe_pt_seq):
        # 过滤掉异常值（比如特别大的值）
        filtered_points = [pt for pt in route if pt[0] < 1000 and pt[1] < 1000]
        
        # 从每个 numpy 数组中提取 x 和 y 坐标
        xs = [pt[0] for pt in filtered_points]
        ys = [pt[1] for pt in filtered_points]
        
        all_xs.extend(xs)
        all_ys.extend(ys)
        
        # 绘制线条, 同时标记出路径点
        plt.plot(xs, ys, marker='o', label=f"Route {idx+1}")
    
    # 设置合适的坐标轴范围
    x_min, x_max = min(all_xs), max(all_xs)
    y_min, y_max = min(all_ys), max(all_ys)
    x_margin = (x_max - x_min) * 0.05
    y_margin = (y_max - y_min) * 0.05
    
    plt.xlim(x_min - x_margin, x_max + x_margin)
    plt.ylim(y_min - y_margin, y_max + y_margin)
    
    plt.xlabel("X 坐标")
    plt.ylabel("Y 坐标")
    plt.title("Pipe Routing Path Diagram")
    plt.grid(True)
    plt.legend()
    plt.axis("equal")  # 保持 x,y 轴比例一致
    plt.show()


if __name__ == "__main__":
    pipe_pt_seq = [
        [
            np.array([135.12490417, 93.24979167]),
            np.array([135.12490417, 71.97049052]),
            np.array([136.48519526, 69.24990833]),
            np.array([137.39642649, 69.24990833]),
            np.array([138.45834167, 68.18799316]),
            np.array([138.45834167, 64.40652616]),
            np.array([138.5, 63.4481845]),
            np.array([138.5, 58.98778771]),
            np.array([138.65625, 55.73778771]),
            np.array([138.65625, 4.20564466]),
            np.array([143.16541801, 1.84365247]),
            np.array([147.8649474, 1.84364902]),
            np.array([148.86495387, 2.15614204]),
            np.array([153.63514709, 2.15613855]),
            np.array([154.63515311, 1.84364406]),
            np.array([168.40348744, 1.84363398]),
            np.array([169.99724435, 2.74987656]),
            np.array([270.01776814, 2.74980328]),
            np.array([273.25, 5.98203278]),
            np.array([273.25, 53.01756695]),
            np.array([270.01776695, 56.2498]),
            np.array([209.23218305, 56.2498]),
            np.array([205.99995, 53.01756695]),
            np.array([205.99995, 11.29700398]),
            np.array([207.18233518, 7.74984932]),
            np.array([268.25, 7.74980458]),
            np.array([268.25, 51.2498]),
            np.array([210.99995, 51.2498]),
            np.array([210.99995, 12.74984652]),
            np.array([263.25, 12.74980824]),
            np.array([263.25, 46.2498]),
            np.array([215.99995, 46.2498]),
            np.array([215.99995, 17.74984286]),
            np.array([258.25, 17.7498119]),
            np.array([258.25, 41.2498]),
            np.array([220.99995, 41.2498]),
            np.array([220.99995, 22.74983919]),
            np.array([253.25, 22.74981557]),
            np.array([253.25, 36.2498]),
            np.array([225.99995, 36.2498]),
            np.array([225.99995, 27.74983553]),
            np.array([248.25, 27.74981923]),
            np.array([248.25, 31.2498]),
            np.array([230.99995, 31.2498]),
            np.array([230.99995, 28.7498]),
            np.array([2.0477745e+06, 2.8749800e+01]),
            np.array([228.49995, 30.2498337]),
            np.array([228.49995, 33.7498]),
            np.array([250.75, 33.7498]),
            np.array([250.75, 25.2498174]),
            np.array([223.49995, 25.24983736]),
            np.array([223.49995, 38.7498]),
            np.array([255.75, 38.7498]),
            np.array([255.75, 20.24981374]),
            np.array([218.49995, 20.24984103]),
            np.array([218.49995, 43.7498]),
            np.array([260.75, 43.7498]),
            np.array([260.75, 15.24981007]),
            np.array([213.49995, 15.24984469]),
            np.array([213.49995, 48.7498]),
            np.array([265.75, 48.7498]),
            np.array([265.75, 10.24980641]),
            np.array([208.98423353, 10.249848]),
            np.array([208.49995, 11.70269822]),
            np.array([208.49995, 51.98203305]),
            np.array([210.26771695, 53.7498]),
            np.array([268.98223305, 53.7498]),
            np.array([270.75, 51.98203305]),
            np.array([270.75, 7.01756722]),
            np.array([268.98223553, 5.24980404]),
            np.array([173.00295931, 5.24987436]),
            np.array([168.22168857, 2.53114661]),
            np.array([154.7400729, 2.53115649]),
            np.array([151.74005484, 3.46863993]),
            np.array([150.76004805, 3.46864065]),
            np.array([147.76002861, 2.5311616]),
            np.array([143.334583, 2.53116484]),
            np.array([139.96875, 4.29425534]),
            np.array([139.96875, 49.26181229]),
            np.array([139.5, 59.01181229]),
            np.array([139.5, 61.5514155]),
            np.array([139.375025, 64.4264405]),
            np.array([139.375025, 67.97844018]),
            np.array([137.60354018, 69.749925]),
            np.array([136.51470474, 69.749925]),
            np.array([135.3749125, 72.02950948]),
            np.array([135.3749125, 93.24979167])
        ],
        [
            np.array([136.1249375, 93.24979167]),
            np.array([136.1249375, 71.97049052]),
            np.array([136.48519526, 71.249975]),
            np.array([137.42377104, 71.249975]),
            np.array([142.125075, 68.09005185]),
            np.array([142.125075, 64.36724873]),
            np.array([142.5, 62.64223373]),
            np.array([142.5, 58.90605]),
            np.array([143.875, 57.8748]),
            np.array([146.06372965, 57.8748]),
            np.array([148.56372965, 58.7498]),
            np.array([153.92583536, 58.7498]),
            np.array([156.42583536, 58.2498]),
            np.array([164.20783797, 58.2498]),
            np.array([167.7501, 60.37515722]),
            np.array([167.7501, 88.07577486]),
            np.array([172.69991787, 94.53211518]),
            np.array([177.48223305, 89.7498]),
            np.array([199.23218305, 89.7498]),
            np.array([205.99995, 82.98203305]),
            np.array([205.99995, 60.37515722]),
            np.array([210.37554536, 57.7498]),
            np.array([242.6279768, 57.7498]),
            np.array([250.75, 62.62301392]),
            np.array([250.75, 87.2498]),
            np.array([212.45279708, 87.2498]),
            np.array([210.99995, 82.89125877]),
            np.array([210.99995, 62.7498]),
            np.array([241.24305697, 62.7498]),
            np.array([245.75, 65.45396582]),
            np.array([245.75, 82.2498]),
            np.array([215.99995, 82.2498]),
            np.array([215.99995, 67.7498]),
            np.array([240.75, 67.7498]),
            np.array([240.75, 77.2498]),
            np.array([220.99995, 77.2498]),
            np.array([220.99995, 72.7498]),
            np.array([235.75, 72.7498]),
            np.array([235.75, 74.7498]),
            np.array([238.25, 74.7498]),
            np.array([238.25, 70.2498]),
            np.array([218.49995, 70.2498]),
            np.array([218.49995, 79.7498]),
            np.array([243.25, 79.7498]),
            np.array([243.25, 66.86944176]),
            np.array([240.55059706, 65.2498]),
            np.array([213.49995, 65.2498]),
            np.array([213.49995, 82.48556462]),
            np.array([214.25469513, 84.7498]),
            np.array([248.25, 84.7498]),
            np.array([248.25, 64.03848987]),
            np.array([241.93551689, 60.2498]),
            np.array([209.12435464, 60.2498]),
            np.array([208.49995, 60.62444278]),
            np.array([208.49995, 83.29695292]),
            np.array([210.65089903, 89.7498]),
            np.array([251.48223305, 89.7498]),
            np.array([253.25, 87.98203305]),
            np.array([253.25, 60.62444278]),
            np.array([250.97100849, 59.25704788]),
            np.array([251.74275212, 57.97080849]),
            np.array([255.75, 60.37515722]),
            np.array([255.75, 89.01756695]),
            np.array([252.51776695, 92.2498]),
            np.array([208.84900097, 92.2498]),
            np.array([206.70367997, 85.81383698]),
            np.array([200.26771695, 92.2498]),
            np.array([178.51776695, 92.2498]),
            np.array([173.51776695, 97.2498]),
            np.array([171.63329189, 97.2498]),
            np.array([165.2501, 88.92382514]),
            np.array([165.2501, 60.62444278]),
            np.array([163.79236203, 59.7498]),
            np.array([156.57436464, 59.7498]),
            np.array([151.85012282, 60.69464836]),
            np.array([145.93627035, 58.6248]),
            np.array([144.125, 58.6248]),
            np.array([143.5, 59.09355]),
            np.array([143.5, 62.35736627]),
            np.array([143.04175833, 64.46571794]),
            np.array([143.04175833, 68.07638148]),
            np.array([137.57619562, 71.74999167]),
            np.array([136.51470474, 71.74999167]),
            np.array([136.37494583, 72.02950948]),
            np.array([136.37494583, 93.24979167])
        ],
        [
            np.array([135.62492083, 93.24979167]),
            np.array([135.62492083, 71.97049052]),
            np.array([136.48519526, 70.24994167]),
            np.array([137.41721794, 70.24994167]),
            np.array([140.29170833, 68.11248497]),
            np.array([140.29170833, 64.38672371]),
            np.array([140.5, 62.7894876]),
            np.array([140.5, 58.9639279]),
            np.array([141.63410133, 51.10082534]),
            np.array([143.81950542, 53.7498]),
            np.array([164.4093131, 53.7498]),
            np.array([172.7501, 59.86637706]),
            np.array([172.7501, 64.07045852]),
            np.array([171.4375625, 71.57045852]),
            np.array([171.4375625, 88.25894926]),
            np.array([172.40660057, 89.7498]),
            np.array([172.48223305, 89.7498]),
            np.array([177.48223305, 84.7498]),
            np.array([199.23218305, 84.7498]),
            np.array([200.99995, 82.98203305]),
            np.array([200.99995, 12.01761778]),
            np.array([199.23218865, 10.24985514]),
            np.array([171.83440534, 10.24987521]),
            np.array([168.11563611, 3.90617169]),
            np.array([154.8235492, 3.90618143]),
            np.array([152.49020289, 6.09363938]),
            np.array([150.00990384, 6.0936412]),
            np.array([147.67655432, 3.90618666]),
            np.array([143.33458421, 3.90618984]),
            np.array([143.1875, 3.9832357]),
            np.array([143.1875, 44.19382109]),
            np.array([146.9461826, 48.7498]),
            np.array([166.04616548, 48.7498]),
            np.array([177.7501, 57.33268532]),
            np.array([177.7501, 67.04266618]),
            np.array([176.875075, 72.04266618]),
            np.array([176.875075, 79.7498]),
            np.array([195.99995, 79.7498]),
            np.array([195.99995, 15.24985751]),
            np.array([167.91920884, 15.24987808]),
            np.array([164.73169236, 9.81241792]),
            np.array([157.15911801, 9.81242346]),
            np.array([155.15910688, 11.68738743]),
            np.array([148.1875, 11.68739254]),
            np.array([148.1875, 42.39752281]),
            np.array([149.30312868, 43.7498]),
            np.array([167.68301786, 43.7498]),
            np.array([182.7501, 54.79899357]),
            np.array([182.7501, 67.47687912]),
            np.array([181.875075, 72.47687912]),
            np.array([181.875075, 74.7498]),
            np.array([190.99995, 74.7498]),
            np.array([190.99995, 20.24986117]),
            np.array([165.05449152, 20.24988018]),
            np.array([161.86697503, 14.81242002]),
            np.array([159.13632121, 14.81242202]),
            np.array([157.13631008, 16.68738598]),
            np.array([153.1875, 16.68738887]),
            np.array([153.1875, 38.7498]),
            np.array([169.31987024, 38.7498]),
            np.array([187.7501, 52.26530183]),
            np.array([187.7501, 67.91109206]),
            np.array([185.99995, 77.91166347]),
            np.array([185.99995, 25.24986484]),
            np.array([162.18977419, 25.24988228]),
            np.array([159.75103145, 21.08972606]),
            np.array([159.11351328, 21.68738453]),
            np.array([158.1875, 21.68738521]),
            np.array([158.1875, 33.7498]),
            np.array([170.95672262, 33.7498]),
            np.array([180.99995, 41.11483341]),
            np.array([180.99995, 30.71468679]),
            np.array([177.51875167, 35.46177543]),
            np.array([171.77514881, 31.2498]),
            np.array([160.6875, 31.2498]),
            np.array([160.6875, 27.74988338]),
            np.array([183.49995, 27.74986667]),
            np.array([183.49995, 46.04834595]),
            np.array([170.13829643, 36.2498]),
            np.array([155.6875, 36.2498]),
            np.array([155.6875, 19.18738704]),
            np.array([158.12491168, 19.18738526]),
            np.array([160.32478164, 17.12505828]),
            np.array([163.62213285, 22.74988123]),
            np.array([188.49995, 22.749863]),
            np.array([188.49995, 72.2498]),
            np.array([184.4528097, 72.2498]),
            np.array([185.2501, 67.69398559]),
            np.array([185.2501, 53.5321477]),
            np.array([168.50144405, 41.2498]),
            np.array([150.6875, 41.2498]),
            np.array([150.6875, 14.18739071]),
            np.array([156.14770848, 14.1873867]),
            np.array([158.14771961, 12.31242274]),
            np.array([163.29933369, 12.31241897]),
            np.array([166.48685018, 17.74987913]),
            np.array([193.49995, 17.74985934]),
            np.array([193.49995, 77.2498]),
            np.array([179.375075, 77.2498]),
            np.array([179.375075, 72.25977265]),
            np.array([180.2501, 67.25977265]),
            np.array([180.2501, 56.06583944]),
            np.array([166.86459167, 46.2498]),
            np.array([148.12465564, 46.2498]),
            np.array([145.6875, 43.29567195]),
            np.array([145.6875, 6.71048673]),
            np.array([148.32960598, 9.18739243]),
            np.array([154.17050528, 9.18738815]),
            np.array([156.17051641, 7.31242419]),
            np.array([166.16405102, 7.31241687]),
            np.array([169.3515675, 12.74987703]),
            np.array([198.49995, 12.74985568]),
            np.array([198.49995, 82.2498]),
            np.array([176.44669914, 82.2498]),
            np.array([174.375075, 84.32142414]),
            np.array([174.375075, 71.82555971]),
            np.array([175.2501, 66.82555971]),
            np.array([175.2501, 58.59953119]),
            np.array([165.22773929, 51.2498]),
            np.array([145.76770956, 51.2498]),
            np.array([140.6875, 45.09197023]),
            np.array([140.6875, 4.5166643]),
            np.array([143.16541881, 3.21867747]),
            np.array([147.9484237, 3.21867396]),
            np.array([149.61510193, 4.78114149]),
            np.array([152.88500288, 4.7811391]),
            np.array([154.55167882, 3.21866912]),
            np.array([168.50954191, 3.2186589]),
            np.array([171.16580564, 7.7498757]),
            np.array([200.26772234, 7.74985438]),
            np.array([203.49995, 10.98208441]),
            np.array([203.49995, 84.01756695]),
            np.array([200.26771695, 87.2498]),
            np.array([178.51776695, 87.2498]),
            np.array([173.51776695, 92.2498]),
            np.array([172.09349943, 92.2498]),
            np.array([169.8125875, 88.74065074]),
            np.array([169.8125875, 71.42934148]),
            np.array([170.2501, 68.92934148]),
            np.array([170.2501, 61.13322294]),
            np.array([163.5908869, 56.2498]),
            np.array([144.18049458, 56.2498]),
            np.array([142.24089867, 53.89877466]),
            np.array([141.5, 59.0356721]),
            np.array([141.5, 62.2101124]),
            np.array([141.20839167, 64.44624295]),
            np.array([141.20839167, 68.05394836]),
            np.array([137.58274873, 70.74995833]),
            np.array([136.51470474, 70.74995833]),
            np.array([135.87492917, 72.02950948]),
            np.array([135.87492917, 93.24979167])
        ]
    ]
    
    plot_pipe_pt_seq(pipe_pt_seq) 